# AuthKit policy security

## Supported versions

| Version | Supported          |
| ------- | ------------------ |
| 0.0.1   | yes                |

## Reporting a vulnerability

Please open an issue in GitHub with:

- the problem description
- an evaluated gravity

If, and only if you consider the vulnerability is servere (like bypass validations or invalid right changes), free feel to contact all project mainteners as declared in pom.xml file. 

Only authkit-relative problems are accepted!
However, misinterpretation of documentation or poorly documented functionality can lead to flaws. Do not hesitate to point out anything that is not completely clear in the documentation.
In that case, open an issue and/or propose a doc pull request.

Keep connected, via Github, of all project updates: some may relate to security.

## Implemented policy

An non-logged guest can't create an account.

No specific "administrator account" rights, just an regular user with all grant rights.

All active users can:

- activate and disable TOTP, even with an LDAP authentication.
- get and update all privacy informations stored in database.
- change password anytime, except those logged by LDAP

All IP restrictions and loggin are for IPv4 and IPv6.

All HTML forms mandatory a JWT token with a short-time (configurable) life.

Except for login operations, users are only denominated by an autogenerated UUID in database/logs.

An user account limit the failed logon tries, and after blocking, only a `SecurityAdmin` can unlock it. `SecurityAdmin` can block future logon for an user.

Expirations:

- Short session time are tuned for 10 min by default.
- Long session time are tuned for 24h by default.

_Argon2_ is the password hasher, configured by default:

- 10 iterations
- 2048 kb
- 2 parallelism

Data hasher (except passwords) use _SHA3-512_.

Data cipher user, configured by default:

- AES
- 12 IV size
- transformation: AES/GCM/NoPadding
- GCMParameterSpecLen 128

Random generator use `NATIVEPRNGNONBLOCKING`, or else use `SecureRandom.getInstanceStrong();`

## Passwords

Password size/complexity have two strategies, only the slight ("default") is enabled.

|Strategie name|password min size|must_have_special_chars
|-|-|-|-|
|default       |8                |no
|strong        |20               |yes

All values are re-configurable.
Complexity is computed after remove:

- spaces
- passwords consisting of repetitive or sequential characters (e.g. ‘aaaaaa’, ‘1234abcd’)
- some generic terms, like "password", "admin", "administrator", "root"
- some context-specific words, such as the name of the service, the username, and derivatives thereof

## RBAC Model

- Users can belong to several Groups
- Users, Credentials information and user privacy metadata are stored in separate tables in database
- Group can acquire several Roles
- Roles are simple aggregates of Rights
- Roles can by conditioned by an IP address
- Right is a Java annotation on Spring Controller
- Any Right can have Context for limit ressource/data acces usage in a controller

User session JWT token handle and keep Right name list.
